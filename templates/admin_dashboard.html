<!DOCTYPE html>
<html>
<head>
  <title>Admin Dashboard - EasyBook</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
  <div class="container py-5">

    <div class="d-flex justify-content-between align-items-center">
      <div>
        <h1 class="mb-1">Admin Dashboard</h1>
        {% if me %}
          <div class="text-muted">Signed in as: <strong>{{ me.first_name }} {{ me.last_name }}</strong> (ID: {{ me.id }})</div>
        {% endif %}
      </div>
      <a class="btn btn-danger" href="/logout">Logout</a>
    </div>

    <div class="mt-4 row g-3">
      <div class="col-md-6">
        <div class="card shadow-sm">
          <div class="card-body">
            <h5 class="card-title">Accounts</h5>
            <p class="mb-1">Total accounts: <strong>{{ total_accounts }}</strong></p>
            <p class="mb-0">Active accounts: <strong>{{ active_accounts }}</strong></p>
            <a class="btn btn-primary mt-3" href="/admin/accounts">Manage Accounts</a>
          </div>
        </div>
      </div>

      <div class="col-md-6">
        <div class="card shadow-sm">
          <div class="card-body">
            <h5 class="card-title">Appointments</h5>
            <p class="mb-0">Quick view of latest appointments</p>
            <a class="btn btn-primary mt-3" href="/admin/appointments">Manage Appointments</a>
          </div>
        </div>
      </div>
    </div>

    <hr class="my-4">

    <h4>Recent Appointments</h4>
    <div class="table-responsive">
      <table class="table table-striped table-bordered bg-white align-middle">
        <thead>
          <tr>
            <th style="width: 90px;">ID</th>
            <th>Details</th>
          </tr>
        </thead>
        <tbody>
          {% for a in appointments %}
          <tr>
            <td>{{ a.id }}</td>
            <td>
              {% if a.account is defined and a.account %}
                <div><strong>Name:</strong> {{ a.account.first_name }} {{ a.account.last_name }}</div>
                <div><strong>User ID:</strong> {{ a.account.id }}</div>
                <div><strong>Email:</strong> {{ a.account.email }}</div>
              {% else %}
                {% if a.user_id is defined %}<div><strong>User ID:</strong> {{ a.user_id }}</div>{% endif %}
                {% if a.email is defined %}<div><strong>Email:</strong> {{ a.email }}</div>{% endif %}
              {% endif %}

              {% if a.date is defined %}<div><strong>Date:</strong> {{ a.date }}</div>{% endif %}
              {% if a.start_time is defined %}
                <div><strong>Time:</strong> {{ a.start_time }}{% if a.end_time is defined %} â€“ {{ a.end_time }}{% endif %}</div>
              {% endif %}
            </td>
          </tr>
          {% else %}
          <tr><td colspan="2">No appointments yet.</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

  </div>
</body>
</html>